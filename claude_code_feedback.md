# Claude Code åŠŸèƒ½æ”¹é€²å»ºè­°

## ğŸ“‹ åŠŸèƒ½è«‹æ±‚æ¦‚è¿°

**æ¨™é¡Œ**: æ™ºèƒ½å®¹å™¨ç’°å¢ƒæª¢æ¸¬èˆ‡è‡ªå‹•åŸ·è¡Œç’°å¢ƒé¸æ“‡

**è«‹æ±‚é¡å‹**: Feature Request

**å„ªå…ˆç´š**: Medium

## ğŸ¯ å•é¡Œæè¿°

### ç•¶å‰è¡Œç‚º

åœ¨å®¹å™¨åŒ–å°ˆæ¡ˆä¸­ï¼ŒClaude Code åœ¨åŸ·è¡Œ Python æ¸¬è©¦æˆ–ä»£ç¢¼é©—è­‰æ™‚ï¼Œæœƒé»˜èªåœ¨å®¿ä¸»æ©Ÿç’°å¢ƒä¸­é‹è¡Œï¼Œè€Œä¸æ˜¯åœ¨å®¹å™¨å…§åŸ·è¡Œã€‚é€™å°è‡´ï¼š

1. **ç’°å¢ƒä¸ä¸€è‡´**: å®¿ä¸»æ©Ÿå’Œå®¹å™¨çš„ Python ç’°å¢ƒã€ä¾è³´ç‰ˆæœ¬å¯èƒ½ä¸åŒ
2. **æ¸¬è©¦çµæœä¸å¯é **: åœ¨å®¿ä¸»æ©Ÿä¸ŠæˆåŠŸçš„ä»£ç¢¼å¯èƒ½åœ¨å®¹å™¨å…§å¤±æ•—
3. **ç”¨æˆ¶å›°æƒ‘**: éœ€è¦æ‰‹å‹•æŒ‡å®šä½¿ç”¨ `docker exec` åŸ·è¡Œ

### å¯¦éš›å ´æ™¯ç¯„ä¾‹

```bash
# Claude Code ç•¶å‰è¡Œç‚º
python -c "æ¸¬è©¦ä»£ç¢¼"  # åœ¨å®¿ä¸»æ©ŸåŸ·è¡Œ

# ç”¨æˆ¶æœŸæœ›çš„æ™ºèƒ½è¡Œç‚º  
docker exec container-name python -c "æ¸¬è©¦ä»£ç¢¼"  # åœ¨å®¹å™¨å…§åŸ·è¡Œ
```

## ğŸ’¡ å»ºè­°çš„è§£æ±ºæ–¹æ¡ˆ

### 1. è‡ªå‹•å®¹å™¨ç’°å¢ƒæª¢æ¸¬

Claude Code æ‡‰è©²èƒ½å¤ æª¢æ¸¬ä»¥ä¸‹æƒ…æ³ï¼š

- å°ˆæ¡ˆæ ¹ç›®éŒ„å­˜åœ¨ `docker-compose.yml` æˆ– `Dockerfile`
- å­˜åœ¨é‹è¡Œä¸­çš„ç›¸é—œå®¹å™¨
- å°ˆæ¡ˆæ–‡æª” (å¦‚ `README.md`, `CLAUDE.md`) ä¸­æåŠå®¹å™¨åŒ–éƒ¨ç½²

### 2. æ™ºèƒ½åŸ·è¡Œç’°å¢ƒé¸æ“‡

**æª¢æ¸¬é‚è¼¯**:
```
if (æœ‰é‹è¡Œä¸­çš„å°ˆæ¡ˆå®¹å™¨) {
    å„ªå…ˆä½¿ç”¨å®¹å™¨å…§åŸ·è¡Œ
} else if (å­˜åœ¨å®¹å™¨é…ç½®æ–‡ä»¶) {
    æç¤ºç”¨æˆ¶é¸æ“‡åŸ·è¡Œç’°å¢ƒ
} else {
    ä½¿ç”¨å®¿ä¸»æ©ŸåŸ·è¡Œ
}
```

**å¯¦ç¾å»ºè­°**:
1. **è‡ªå‹•æª¢æ¸¬**: ä½¿ç”¨ `docker ps` æŸ¥æ‰¾ç›¸é—œå®¹å™¨
2. **æ™ºèƒ½åŒ¹é…**: æ ¹æ“šå°ˆæ¡ˆåç¨±æˆ–ç›®éŒ„åç¨±åŒ¹é…å®¹å™¨
3. **ç”¨æˆ¶ç¢ºèª**: ç¬¬ä¸€æ¬¡æª¢æ¸¬åˆ°æ™‚è©¢å•ç”¨æˆ¶åå¥½
4. **è¨˜æ†¶é¸æ“‡**: ä¿å­˜ç”¨æˆ¶é¸æ“‡ç”¨æ–¼å¾ŒçºŒåŸ·è¡Œ

### 3. ç”¨æˆ¶ç•Œé¢æ”¹é€²

#### é¸é … A: è‡ªå‹•æç¤º
```
ğŸ³ æª¢æ¸¬åˆ°å®¹å™¨åŒ–å°ˆæ¡ˆï¼Œç™¼ç¾é‹è¡Œä¸­çš„å®¹å™¨: rag-intelligent-assistant
æ˜¯å¦åœ¨å®¹å™¨å…§åŸ·è¡Œæ¸¬è©¦ï¼Ÿ [Y/n]
```

#### é¸é … B: é…ç½®é¸é …
```
// åœ¨ç”¨æˆ¶è¨­å®šä¸­æ·»åŠ 
"container_execution_preference": "auto" | "always_host" | "always_container" | "ask"
```

#### é¸é … C: å‘½ä»¤æç¤º
```
ğŸ’¡ æç¤º: æª¢æ¸¬åˆ°å®¹å™¨ç’°å¢ƒï¼Œå»ºè­°ä½¿ç”¨:
docker exec rag-intelligent-assistant python -c "æ¸¬è©¦ä»£ç¢¼"
```

## ğŸ”§ æŠ€è¡“å¯¦ç¾å»ºè­°

### æª¢æ¸¬å®¹å™¨çš„æ–¹æ³•

```javascript
// å½ä»£ç¢¼ç¤ºä¾‹
function detectContainerEnvironment() {
    // 1. æª¢æŸ¥é‹è¡Œä¸­çš„å®¹å™¨
    const containers = execSync('docker ps --format "{{.Names}}"').toString();
    
    // 2. åŒ¹é…å°ˆæ¡ˆç›¸é—œå®¹å™¨
    const projectName = getProjectName(); // å¾ç›®éŒ„åæˆ–é…ç½®ç²å–
    const relevantContainers = containers
        .split('\n')
        .filter(name => name.includes(projectName));
    
    // 3. æª¢æŸ¥å®¹å™¨é…ç½®æ–‡ä»¶
    const hasDockerCompose = fs.existsSync('docker-compose.yml');
    const hasDockerfile = fs.existsSync('Dockerfile');
    
    return {
        hasContainers: relevantContainers.length > 0,
        containerNames: relevantContainers,
        hasContainerConfig: hasDockerCompose || hasDockerfile
    };
}
```

### åŸ·è¡Œç’°å¢ƒé¸æ“‡é‚è¼¯

```javascript
function chooseExecutionEnvironment(command) {
    const containerInfo = detectContainerEnvironment();
    
    if (containerInfo.hasContainers) {
        const containerName = containerInfo.containerNames[0]; // æˆ–è®“ç”¨æˆ¶é¸æ“‡
        return `docker exec ${containerName} ${command}`;
    }
    
    return command; // å›é€€åˆ°å®¿ä¸»æ©ŸåŸ·è¡Œ
}
```

## ğŸ“ˆ æœŸæœ›çš„ç”¨æˆ¶é«”é©—

### æ”¹é€²å‰
```
ç”¨æˆ¶: "æ¸¬è©¦é€™å€‹åŠŸèƒ½"
Claude: åŸ·è¡Œ python test.py
çµæœ: åœ¨å®¿ä¸»æ©ŸåŸ·è¡Œï¼Œå¯èƒ½å› ç’°å¢ƒå·®ç•°å¤±æ•—
```

### æ”¹é€²å¾Œ
```
ç”¨æˆ¶: "æ¸¬è©¦é€™å€‹åŠŸèƒ½" 
Claude: ğŸ³ æª¢æ¸¬åˆ°å®¹å™¨ç’°å¢ƒï¼Œåœ¨å®¹å™¨å…§åŸ·è¡Œæ¸¬è©¦
Claude: åŸ·è¡Œ docker exec rag-app python test.py
çµæœ: åœ¨å®¹å™¨å…§åŸ·è¡Œï¼Œçµæœæ›´å¯é 
```

## ğŸ é¡å¤–åŠŸèƒ½å»ºè­°

### 1. å®¹å™¨ç‹€æ…‹æª¢æŸ¥
- è‡ªå‹•æª¢æŸ¥å®¹å™¨æ˜¯å¦é‹è¡Œ
- æä¾›å•Ÿå‹•å®¹å™¨çš„å»ºè­°

### 2. å¤šå®¹å™¨æ”¯æŒ
- æª¢æ¸¬ä¸¦åˆ—å‡ºæ‰€æœ‰ç›¸é—œå®¹å™¨
- è®“ç”¨æˆ¶é¸æ“‡ç›®æ¨™å®¹å™¨

### 3. é…ç½®è¨˜æ†¶
- è¨˜ä½ç”¨æˆ¶çš„åŸ·è¡Œç’°å¢ƒåå¥½
- æ”¯æ´å°ˆæ¡ˆç´šåˆ¥çš„é…ç½®è¦†è“‹

## ğŸ”— ç›¸é—œé …ç›®æ¡ˆä¾‹

è¨±å¤šå®¹å™¨åŒ–å°ˆæ¡ˆéƒ½æœƒé‡åˆ°é€™å€‹å•é¡Œï¼š
- Node.js å°ˆæ¡ˆä½¿ç”¨ Docker Compose
- Python å¾®æœå‹™æ¶æ§‹
- å…¨ç«¯é–‹ç™¼ç’°å¢ƒ
- CI/CD æµæ°´ç·šæ¸¬è©¦

## ğŸ“Š å½±éŸ¿è©•ä¼°

**å—ç›Šç”¨æˆ¶ç¾¤é«”**:
- ä½¿ç”¨ Docker çš„é–‹ç™¼è€… (ç´„ 70% çš„ç¾ä»£é–‹ç™¼å°ˆæ¡ˆ)
- å¾®æœå‹™æ¶æ§‹é–‹ç™¼è€…
- DevOps å·¥ç¨‹å¸«

**å¯¦ç¾è¤‡é›œåº¦**: ä¸­ç­‰
**ç”¨æˆ¶åƒ¹å€¼**: é«˜
**å‘å¾Œå…¼å®¹æ€§**: å®Œå…¨å…¼å®¹

## ğŸ·ï¸ æ¨™ç±¤å»ºè­°

- `enhancement`
- `docker`
- `container`
- `environment-detection`
- `user-experience`

---

**æäº¤è€…**: RAG ç³»çµ±é–‹ç™¼è€…
**æ—¥æœŸ**: 2025-08-22
**å°ˆæ¡ˆç¯„ä¾‹**: https://github.com/anthropics/claude-code/issues

## é™„åŠ èªªæ˜

é€™å€‹åŠŸèƒ½æ”¹é€²å°‡å¤§å¤§æå‡ Claude Code åœ¨å®¹å™¨åŒ–é–‹ç™¼ç’°å¢ƒä¸­çš„ä½¿ç”¨é«”é©—ï¼Œæ¸›å°‘ç’°å¢ƒä¸ä¸€è‡´å°è‡´çš„å•é¡Œï¼Œæé«˜é–‹ç™¼æ•ˆç‡ã€‚æœŸå¾…èƒ½åœ¨æœªä¾†ç‰ˆæœ¬ä¸­çœ‹åˆ°é€™å€‹åŠŸèƒ½ï¼